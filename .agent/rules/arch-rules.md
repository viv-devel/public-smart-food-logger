---
trigger: always_on
---

# ワークスペース・アーキテクチャ定義 (グローバル設定)

## 1. モノレポ構造のコンポーネント

| コンポーネント名 | 役割                                            | デプロイ先           |
| :--------------- | :---------------------------------------------- | :------------------- |
| **frontend**     | ユーザーインターフェース（WEBフロントエンド）。 | Netlify              |
| **backend**      | APIおよび認証処理（ビジネスロジック）。         | Cloud Run (Function) |
| **shared**       | 共通の型定義、ユーティリティコード。            | (個別デプロイは無し) |

## 2. CI/CD 環境の定義（5種類）

環境は、ブランチや目的に応じて以下の5種類が存在する。

| 環境名 (Key)    | 役割                                                   | 連携ブランチ     | デプロイサービス (例)     |
| :-------------- | :----------------------------------------------------- | :--------------- | :------------------------ |
| **Production**  | 安定版。ユーザー利用の最終環境。                       | `main`           | Netlify, Cloud Run        |
| **Staging**     | リリース候補版 (RC)。統合テスト・最終検証用。          | `develop`        | Netlify, Cloud Run        |
| **Preview**     | 個別機能検証用。PR作成時に一時的に生成される。         | Feature ブランチ | Netlify, backendはなし (予定)    |
| **CI**          | 継続的インテグレーション専用。テスト・ビルドチェック。 | PR チェック      | GitHub Actions (ランナー) |
| **Development** | 開発者のローカル環境。                                 | Local Machine    | Local Server              |

## 3. 外部サービス連携 (Fitbit)

- **サービス:** Fitbit WEBアプリ連携 (OAuth認証を使用)
- **環境依存:** Production、Staging、Development（local）の3環境それぞれで、**異なるコールバックURL**と**クライアント設定**が必要である。

## 4. デプロイ手段

- すべてのデプロイは **GitHub Actions のワークフロー**から実行される。
